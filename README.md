## Overview

Discount is a Spark-based tool for k-mer counting, and for analysis of minimizer orderings.

This software includes [Fastdoop](https://github.com/umbfer/fastdoop) by U.F. Petrillo et al [1].
We have also included some of the [DOCKS](http://acgt.cs.tau.ac.il/docks/) sets generated by Y Orenstein et al [2].
 
## Compiling

Discount has been developed and tested with Scala 2.11 and Spark 2.4.
In Google Cloud, we use Dataproc image version 1.4 (Debian 9, Hadoop 2.9, Spark 2.4).
In addition to a working Spark installation, the sbt build tool is also needed.

The command `sbt package` will produce the necessary jar file.

Copy spark-submit.sh.template to spark-submit.sh and edit the necessary variables in the file.
Alternatively, if you submit to a GCloud cluster, you can use submit-gcloud.sh.template.

## Usage (k-mer counting)

Example (statistical overview of a dataset) where k = 55, m = 10 

`
./submit-discount.sh -k 55 -w 10 /path/to/data.fastq stats
`

Example (full counts table output with k-mer sequences)

`
./submit-discount.sh -k 55 -w 10 /path/to/data.fastq count -o /path/to/output/dir --sequence
`

To get help:

`
./submit-discount.sh --help
`

## Usage (minimizer ordering evaluation)

To be written

## References

1. Petrillo, U. F., Roscigno, G., Cattaneo, G., & Giancarlo, R. (2017). FASTdoop: A versatile and efficient library for the input of FASTA and FASTQ files for MapReduce Hadoop bioinformatics applications. Bioinformatics, 33(10), 1575–1577.
2. Orenstein, Y., Pellow, D., Marçais, G., Shamir, R., & Kingsford, C . (2017). Designing small universal k-mer hitting sets for improved analysis of high-throughput sequencing. PLoS Computational Biology, 13(10), 1–15. https://doi.org/10.1371/journal.pcbi.1005777
